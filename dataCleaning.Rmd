---
title: "dataCleaning"
author: "Margaret Bassney"
date: "2/24/2022"
output: html_document
---


This basically just has all that Carlotta did just in a markdown file and with housework_satisfied included and na's converted to zero's. We can do something different with them later but i just did that for now. 

```{r}
# import libraries
library(tidyverse)
library(psych)
```

```{r}
# import dataset
dat <- read.csv("TeleCom_Dyad_premeasures.csv")
head(dat)
```
age ethnicity household income relationship length working from home (working from home), heterosexual income race, interracial 

```{r}
# selecting the variables we need
dat <- dat %>%
  select(dyadID, partnum, gender, religion, starts_with("housework_"), starts_with("grbs_"))
head(dat)
```

```{r}
# re-coding housework to be numbers 
dat$housework_1<-recode(dat$housework_1, "Mostly or always my partner(0-20% me)"=20, 
                        "More likely my partner(20-40% me)"=40, "Shared about equally(40-60% me)"=60, 
                        "More likely me(60-80% me)"=80, "Mostly or always me(80-100% me)"=100)
dat$housework_2<-recode(dat$housework_2, "Mostly or always my partner(0-20% me)"=20, 
                        "More likely my partner(20-40% me)"=40, "Shared about equally(40-60% me)"=60, 
                        "More likely me(60-80% me)"=80, "Mostly or always me(80-100% me)"=100)
dat$housework_3<-recode(dat$housework_3, "Mostly or always my partner(0-20% me)"=20, 
                        "More likely my partner(20-40% me)"=40, "Shared about equally(40-60% me)"=60, 
                        "More likely me(60-80% me)"=80, "Mostly or always me(80-100% me)"=100)
dat$housework_4<-recode(dat$housework_4, "Mostly or always my partner(0-20% me)"=20, 
                        "More likely my partner(20-40% me)"=40, "Shared about equally(40-60% me)"=60, 
                        "More likely me(60-80% me)"=80, "Mostly or always me(80-100% me)"=100)
dat$housework_5<-recode(dat$housework_5, "Mostly or always my partner(0-20% me)"=20, 
                        "More likely my partner(20-40% me)"=40, "Shared about equally(40-60% me)"=60, 
                        "More likely me(60-80% me)"=80, "Mostly or always me(80-100% me)"=100)
dat$housework_6<-recode(dat$housework_6, "Mostly or always my partner(0-20% me)"=20, 
                        "More likely my partner(20-40% me)"=40, "Shared about equally(40-60% me)"=60, 
                        "More likely me(60-80% me)"=80, "Mostly or always me(80-100% me)"=100)
dat$housework_7<-recode(dat$housework_7, "Mostly or always my partner(0-20% me)"=20, 
                        "More likely my partner(20-40% me)"=40, "Shared about equally(40-60% me)"=60, 
                        "More likely me(60-80% me)"=80, "Mostly or always me(80-100% me)"=100)
dat$housework_8<-recode(dat$housework_8, "Mostly or always my partner(0-20% me)"=20, 
                        "More likely my partner(20-40% me)"=40, "Shared about equally(40-60% me)"=60, 
                        "More likely me(60-80% me)"=80, "Mostly or always me(80-100% me)"=100)
dat$housework_9<-recode(dat$housework_9, "Mostly or always my partner(0-20% me)"=20, 
                        "More likely my partner(20-40% me)"=40, "Shared about equally(40-60% me)"=60, 
                        "More likely me(60-80% me)"=80, "Mostly or always me(80-100% me)"=100)
dat$housework_10<-recode(dat$housework_10, "Mostly or always my partner(0-20% me)"=20, 
                        "More likely my partner(20-40% me)"=40, "Shared about equally(40-60% me)"=60, 
                        "More likely me(60-80% me)"=80, "Mostly or always me(80-100% me)"=100)
dat$housework_11<-recode(dat$housework_11, "Mostly or always my partner(0-20% me)"=20, 
                        "More likely my partner(20-40% me)"=40, "Shared about equally(40-60% me)"=60, 
                        "More likely me(60-80% me)"=80, "Mostly or always me(80-100% me)"=100)
dat$housework_12<-recode(dat$housework_12, "Mostly or always my partner(0-20% me)"=20, 
                        "More likely my partner(20-40% me)"=40, "Shared about equally(40-60% me)"=60, 
                        "More likely me(60-80% me)"=80, "Mostly or always me(80-100% me)"=100)
dat$housework_13<-recode(dat$housework_13, "Mostly or always my partner(0-20% me)"=20, 
                        "More likely my partner(20-40% me)"=40, "Shared about equally(40-60% me)"=60, 
                        "More likely me(60-80% me)"=80, "Mostly or always me(80-100% me)"=100)
dat$housework_14<-recode(dat$housework_14, "Mostly or always my partner(0-20% me)"=20, 
                        "More likely my partner(20-40% me)"=40, "Shared about equally(40-60% me)"=60, 
                        "More likely me(60-80% me)"=80, "Mostly or always me(80-100% me)"=100)
```

```{r}
# re-coding housework fairness
dat$housework_fair<-recode(dat$housework_fair, "Fair to both you and your partner"=3, "Slightly unfair to you"=4, 
                           "Very fair to me"=1, "Pretty much fair to me"=2, "Very unfair to you"=5)

```

```{r}
# re-coding gender role beliefs 
dat$grbs_1<-recode(dat$grbs_1, "Strongly disagree"=1, "Somewhat disagree"=2, "Neither agree nor disagree"=3, 
                   "Somewhat agree"=4, "Strongly agree"=5)
dat$grbs_2<-recode(dat$grbs_2, "Strongly disagree"=1, "Somewhat disagree"=2, "Neither agree nor disagree"=3, 
                   "Somewhat agree"=4, "Strongly agree"=5)
dat$grbs_3<-recode(dat$grbs_3, "Strongly disagree"=1, "Somewhat disagree"=2, "Neither agree nor disagree"=3, 
                   "Somewhat agree"=4, "Strongly agree"=5)
dat$grbs_4<-recode(dat$grbs_4, "Strongly disagree"=1, "Somewhat disagree"=2, "Neither agree nor disagree"=3, 
                   "Somewhat agree"=4, "Strongly agree"=5)
dat$grbs_5<-recode(dat$grbs_5, "Strongly disagree"=1, "Somewhat disagree"=2, "Neither agree nor disagree"=3, 
                   "Somewhat agree"=4, "Strongly agree"=5)
dat$grbs_6<-recode(dat$grbs_6, "Strongly disagree"=1, "Somewhat disagree"=2, "Neither agree nor disagree"=3, 
                   "Somewhat agree"=4, "Strongly agree"=5)
dat$grbs_7<-recode(dat$grbs_7, "Strongly disagree"=1, "Somewhat disagree"=2, "Neither agree nor disagree"=3, 
                   "Somewhat agree"=4, "Strongly agree"=5)
dat$grbs_8<-recode(dat$grbs_8, "Strongly disagree"=1, "Somewhat disagree"=2, "Neither agree nor disagree"=3, 
                   "Somewhat agree"=4, "Strongly agree"=5)
dat$grbs_9<-recode(dat$grbs_9, "Strongly disagree"=1, "Somewhat disagree"=2, "Neither agree nor disagree"=3, 
                   "Somewhat agree"=4, "Strongly agree"=5)
dat$grbs_10<-recode(dat$grbs_10, "Strongly disagree"=1, "Somewhat disagree"=2, "Neither agree nor disagree"=3, 
                   "Somewhat agree"=4, "Strongly agree"=5)
dat$grbs_11<-recode(dat$grbs_11, "Strongly disagree"=1, "Somewhat disagree"=2, "Neither agree nor disagree"=3, 
                   "Somewhat agree"=4, "Strongly agree"=5)
dat$grbs_12<-recode(dat$grbs_12, "Strongly disagree"=1, "Somewhat disagree"=2, "Neither agree nor disagree"=3, 
                   "Somewhat agree"=4, "Strongly agree"=5)
dat$grbs_13<-recode(dat$grbs_13, "Strongly disagree"=1, "Somewhat disagree"=2, "Neither agree nor disagree"=3, 
                   "Somewhat agree"=4, "Strongly agree"=5)
dat$grbs_14<-recode(dat$grbs_14, "Strongly disagree"=1, "Somewhat disagree"=2, "Neither agree nor disagree"=3, 
                   "Somewhat agree"=4, "Strongly agree"=5)
dat$grbs_15<-recode(dat$grbs_15, "Strongly disagree"=1, "Somewhat disagree"=2, "Neither agree nor disagree"=3, 
                   "Somewhat agree"=4, "Strongly agree"=5)
dat$grbs_16<-recode(dat$grbs_16, "Strongly disagree"=1, "Somewhat disagree"=2, "Neither agree nor disagree"=3, 
                   "Somewhat agree"=4, "Strongly agree"=5)
dat$grbs_17<-recode(dat$grbs_17, "Strongly disagree"=1, "Somewhat disagree"=2, "Neither agree nor disagree"=3, 
                   "Somewhat agree"=4, "Strongly agree"=5)
dat$grbs_18<-recode(dat$grbs_18, "Strongly disagree"=1, "Somewhat disagree"=2, "Neither agree nor disagree"=3, 
                   "Somewhat agree"=4, "Strongly agree"=5)
dat$grbs_19<-recode(dat$grbs_19, "Strongly disagree"=1, "Somewhat disagree"=2, "Neither agree nor disagree"=3, 
                   "Somewhat agree"=4, "Strongly agree"=5)
dat$grbs_20<-recode(dat$grbs_20, "Strongly disagree"=1, "Somewhat disagree"=2, "Neither agree nor disagree"=3, 
                   "Somewhat agree"=4, "Strongly agree"=5)
```

```{r}
# re-coding housework_satisfied
dat$housework_satisfied<-recode(dat$housework_satisfied, "Very dissatisfied" = 1, "Somewhat dissatisfied" = 2, "Neither satisfied nor dissatisfied" = 3, "Somewhat satisfied" = 4, "Very satisfied" = 5)
```


```{r}
head(dat)
```



na.rm=false 

```{r}
# re-coding the NA's to be 0's
#dat[is.na(dat)]<- 0
#head(dat)
```

```{r}
# adding an average housework column, is it na.rm=FALSE or TRUE?
# we can't use these ~ still wrong, reversed etc.
head(dat)
dat$avg_housework = rowMeans(dat[,c(5:18)], na.rm=FALSE)
head(dat)

# adding an average grbs column
dat$avg_grbs = rowMeans(dat[,c(21:40)])

# overall dataset with means
overall_data <- dat %>%
  select(dyadID, gender, religion, avg_housework, avg_grbs, housework_fair, housework_satisfied)

head(overall_data)
```


```{r}
# Correlation housework
corr.test(select(dat, housework_1, housework_2, housework_3, housework_4, 
                 housework_5, housework_6, housework_7, housework_8, housework_9, 
                 housework_10, housework_11, housework_12, housework_13, housework_14))$r
```
We can see that there are negative correlations. > type of chore= male/female 

5=Take out garbage, recycling
6=Outdoor work (yard work, rake, mow, shovel snow, garden)  
10=Upkeep of car including repairs, washing and vacuuming  
11=Small repairs around the house


```{r}
# Correlation divided by housework type
corr.test(select(dat, housework_1, housework_2, housework_3, housework_4, 
                 housework_7, housework_8, housework_9, 
                 housework_12, housework_13, housework_14))$r
corr.test(select(dat, housework_5, housework_6, 
                 housework_10, housework_11))$r
```

```{r}
# Average of each housework_type, for all females
dat <- dat %>%
  mutate(avg_housework_female = rowMeans(select(dat,housework_1, housework_2, housework_3, housework_4, housework_7, housework_8, 
         housework_9, housework_12, housework_13, housework_14),na.rm = TRUE))

```


```{r}
# Average divided by housework type
#dat$avg_housework_female = rowMeans(dat[(housework_1, housework_2, housework_3, housework_4, housework_7, housework_8, housework_9, housework_12, housework_13, housework_14)], na.rm=TRUE)

#I tried some stuff, it didnt really work though!
# housework_female = c(dat$housework_1, dat$housework_2, dat$housework_3, dat$housework_4, dat$housework_7, dat$housework_8, dat$housework_9, dat$housework_12, dat$housework_13, dat$housework_14)
# 
# dat %>% 
#   na.omit() %>%
#   mutate(avg_housework_f = rowMeans(select(., housework_female)), na.rm=FALSE)
# 
# newdata$avg_housework_male = rowMeans(dat[,c(7:8, 12:13)], na.rm=FALSE)
```

```{r}
# Correlation for women - housework
corr.test(select(avg_housework_female, housework_1, housework_2, housework_3, housework_4, housework_7, housework_8, 
         housework_9, housework_12, housework_13, housework_14))$r
```

```{r}
# Average of each housework_type, for all men

avg_housework_man <- dat %>%
  filter(gender == "Man") %>%
  select(housework_1, housework_2, housework_3, housework_4, housework_7, housework_8, 
         housework_9, housework_12, housework_13, housework_14)  %>%
  na.omit()

colMeans(avg_housework_man)
```

```{r}
# Correlation  for men - housework
corr.test(select(avg_housework_man, housework_1, housework_2, housework_3, housework_4, housework_7, housework_8, 
         housework_9, housework_12, housework_13, housework_14))$r
```

```{r}
# Correlation grbs
dat
corr.test(select(dat, grbs_1, grbs_2,grbs_3,grbs_4,grbs_5,grbs_6,grbs_7,grbs_8,
                 grbs_9, grbs_10, grbs_11, grbs_12, grbs_13, grbs_14, grbs_15, 
                 grbs_16, grbs_17, grbs_18, grbs_19, grbs_20))$r
```
We should check for reversed items!! 2y 3y 7 10 12 17





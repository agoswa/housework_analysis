---
title             : "Satisfying housework division? Gender role beliefs and religion as moderators of housework division and satisfaction"
shorttitle        : "gender roles, housework and satisfaction"

author: 
  - name          : "Carlotta Reinhardt"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding 
  - name          : "Margaret Bassney"
    affiliation   : "1"
  - name          : "Anushree Goswami"
    affiliation   : "1"
affiliation:
  - id            : "1"
    institution   : "Smith College"
   
# authornote: 

bibliography      : ["r-references.bib"]


floatsintext      : yes
figurelist        : yes
tablelist         : yes
footnotelist      : no
linenumbers       : yes
mask              : no
draft             : no

documentclass     : "apa6"
classoption       : "man"
output            : papaja::apa6_pdf
---

```{r analysis-preferences}
# Seed for random number generation
set.seed(42)
knitr::opts_chunk$set(cache.extra = knitr::rand_seed)
knitr::opts_chunk$set(include = FALSE)
```

```{r}
library(tidyverse)
library(nlme)
library(dplyr)
library(ggplot2)
```

```{r, include = FALSE}
dat_reverse <- read.csv("dat_reverse.csv")
dat_predyad <- read.csv("predyaddata.csv")
dat_dyad <- read.csv("dyadic.csv")
dat <- read.csv("TeleCom_Dyad_premeasures.csv")
```

## Analysis Strategy  
To test our hypotheses that gender role beliefs moderate the relationship between housework distribution and satisfaction with the distribution, we used multilevel modeling and the Actor-Partner Interdependence Model (APIM; Kenny, Kashy, & Cook, 2006). The APIM measures the effect of the explanatory variable for both members in a dyad at the same time. This way we get both the actor and partner effects. We will be able to see how one partners housework distribution effects both their own satisfaction with the distribution and their partners satisfaction with the distributions. In terms of moderation, we will get an actor effect moderated by each members gender role beliefs and a partner effect moderated by each members gender role beliefs. The APIM measures proportion of variance in satisfaction that occurs between dyads vs the total variation present. In other words, how much of the variation in satisfaction is caused by the dyad. This allows us to estimate satisfaction with the distribution of housework is a function of both housework distribution and the the random errors at both the individual and dyad level. This accounts for the nonindependent data. 
In order to calculate our APIM's we had to put our data into a paired data structure, where both the actor and the partner's data was contained all in one line. This way we could calculate the actor and partner effects for both the husbands and wives. 


(ref:my-figure-caption) Actor Partner Effects in the APIM

```{r my-figure, fig.cap = "(ref:my-figure-caption)", include=TRUE}
knitr::include_graphics("APIM_Housework_Distribution.pdf")
```



## Main Results


```{r}
## centering moderator and predictor
## calculate difference btw each individuals score and the grand mean of the entire sample
dat_dyad <- dat_dyad %>%
  mutate(
    Cavg_housework_female_A =  avg_housework_female_A- mean(avg_housework_female_A, na.rm = TRUE),
    Cavg_housework_female_P =  avg_housework_female_P- mean(avg_housework_female_P, na.rm = TRUE),
    Cavg_grbs_A =  avg_grbs_A- mean(avg_grbs_A, na.rm = TRUE),
    Cavg_grbs_P =  avg_grbs_P- mean(avg_grbs_P, na.rm = TRUE),
    religionYN_A = ifelse((religion_A == "Athiest"| religion_A =="Agnostic"),"N","Y"),
    religionYN_P = ifelse((religion_P == "Athiest"|religion_A == "Agnostic"), "N","Y"))
    
```

**Outcome: [housework_satisfied_A] Satisfaction **
**Predictor Variables:  [avg_housework_female_A,avg_housework_female_P] Avg** **housework distribution(female tasks) of the actor and the partner**
```{r}
## just the actor partner effects no moderation
basic_mod<- gls(housework_satisfied_A~as.factor(genderE_A)+
                    Cavg_housework_female_A:as.factor(genderE_A)+
                    Cavg_housework_female_P:as.factor(genderE_A),
                  data = dat_dyad,
                  correlation = corCompSymm(form=~1|dyadID), 
                  weights = varIdent(form=~1|as.factor(genderE_A)), 
                  na.action = na.omit)
summary(basic_mod)

```

Wife's house work distribution on her own satisfaction with the housework distribution was `r basic_mod$coefficients[2]`. Wife's house work distribution on her husbands satisfaction with the housework distribution was `r basic_mod$coefficients[6]`.Husband's house work distribution on his own satisfaction with the housework distribution was `r basic_mod$coefficients[4]`. Husband's house work distribution on his wife's satisfaction with the housework distribution was `r basic_mod$coefficients[5]`.


```{r}

```


**Outcome: [housework_satisfied_A] Satisfaction** 
**Predictor Variables:  [avg_housework_female_A,avg_housework_female_P] Avg** **housework distribution(female tasks) of the actor and the partner **
**Moderators: [avg_grbs_A, avg_grbs_P] Gender role beleifs of the actor and the partner **
 

```{r}
## two intercept model gives us the two coefficients for men and women
#this model removes the grand mean so we are only left with actor/partner effects 
## using grbs and gender as a moderator
## we don't need every single combination as an interaction term, so we only kept the ones that we are interested in and haven't already calculated. 
## by removing extra parameters we will get more accurate estimates.
two_int_mod<- gls(housework_satisfied_A~as.factor(genderE_A)+
                    Cavg_housework_female_A:as.factor(genderE_A)+
                    Cavg_housework_female_P:as.factor(genderE_A)+
                    Cavg_grbs_A:as.factor(genderE_A)+
                    Cavg_grbs_P:as.factor(genderE_A)+
                    Cavg_housework_female_A:Cavg_grbs_A:as.factor(genderE_A)+
                    Cavg_housework_female_P:Cavg_grbs_P:as.factor(genderE_A)+
                    Cavg_housework_female_A:Cavg_grbs_P:as.factor(genderE_A)+
                    Cavg_housework_female_P:Cavg_grbs_A:as.factor(genderE_A) -1,
                    data = dat_dyad,
                    correlation = corCompSymm(form=~1|dyadID), 
                    weights = varIdent(form=~1|as.factor(genderE_A) ), 
                    na.action = na.omit)
coef(summary(two_int_mod))
```
We found four significant parameter estimates. Only two of which were moderation effects. 


The interaction between the actors gender and housework distribution and gender role beliefs was significant when the actor was the husband 

estimate 0.0686374108
p-val 4.776644e-04


positive effect on satisfaction with the more housework he does, if his gender role beleifs are more traditional 

The interaction between the actors gender, the actors house work distribution, and their partners gender role beliefs were significant when the actor was the husband.

estimate -0.0669358877
p-val   1.066857e-03

negative effect on satisfaction with the more housework he does, if his partners gender role beliefs are more traditional

the other two effects were just the effect of being male and the effect of being female on satisfaction.

```{r}
#moderation approach
# moderation approach lets us know the difference between gender coefficients. are #the coefficients for men and women statistically different.
## check for gender interactions
mod<- gls(housework_satisfied_A ~ 
                Cavg_housework_female_A*Cavg_grbs_A*genderE_A +
                Cavg_housework_female_A*Cavg_grbs_P*genderE_A+
                Cavg_housework_female_P*Cavg_grbs_A*genderE_A +
                Cavg_housework_female_P*Cavg_grbs_P*genderE_A,
                    data = dat_dyad,
                    correlation = corCompSymm(form=~1|dyadID), 
                    weights = varIdent(form=~1|genderE_A), 
                    na.action = na.omit)

coef(summary(mod))
```

 Only looking at the three way interactions with gender we found two significant gender differences in the moderation effects. 

The interaction between actors housework distribution and their own gender role beliefs was significantly different for husbands and wives 

estimate 0.062986556
p-val  3.154078e-02

as the actors housework distribution increases, and their gender role beleifs are more traditional, satisfaction tended to be 0.062986556 higher for husbands than wives. 

The interaction between actors housework distribution and their partners gender role beliefs was significantly different for husbands and wives 

estimate   -0.077597303
p-val   7.190096e-03

as the actors housework distribution increases, and their partners gender role beliefs are more traditional, satisfaction tended to be 0.077597303 lower for husbands than wives.


```{r}
husbands <- dat_dyad %>%
  filter(genderE_A == 1)
```

```{r, include = TRUE}
husband_plot<- ggplot(husbands,aes(
                x = Cavg_housework_female_A,
                y = housework_satisfied_A, color = Cavg_grbs_A)
                )+
  geom_point()+
  geom_smooth(method = "lm")+
  labs(x = "housework distribution", y = "Satisfaction", title = "INteraction of husbands housework distribution and their gender role beleifs")
  
husband_plot
```


**Outcome: [housework_satisfied_A] Satisfaction** 
**Predictor Variables:  [avg_housework_female_A,avg_housework_female_P] Avg** **housework distribution(female tasks) of the actor and the partner **
**Moderators: [religionYN_A,religionYN_P] Gender role beleifs of the actor and the partner **


```{r}
## two intercept model
#this model removes the grand mean
## using religion and gender as  moderators
two_int_mod_religion<- gls(housework_satisfied_A~as.factor(genderE_A)+
                    Cavg_housework_female_A:as.factor(genderE_A)+
                    Cavg_housework_female_P:as.factor(genderE_A)+
                    religionYN_A:as.factor(genderE_A)+
                    #religionYN_P:as.factor(genderE_A)+
                    Cavg_housework_female_A:religionYN_A:as.factor(genderE_A)+
                    Cavg_housework_female_P:religionYN_P:as.factor(genderE_A)+
                    Cavg_housework_female_A:religionYN_P:as.factor(genderE_A)+
                    Cavg_housework_female_P:religionYN_A:as.factor(genderE_A) -1,
                    data = dat_dyad,
                    correlation = corCompSymm(form=~1|dyadID), 
                    weights = varIdent(form=~1|as.factor(genderE_A) ), 
                    na.action = na.omit)
coef(summary(two_int_mod_religion))
```
The two intercept model gives us the two coefficients for men and women

```{r}
#moderation approach
## check for gender interactions
 int_mod_religion<- gls(housework_satisfied_A ~
                       Cavg_housework_female_A*religionYN_A*genderE_A+
                       # Cavg_housework_female_A*religionYN_P*genderE_A+
                       Cavg_housework_female_P*religionYN_A*genderE_A,
                       # Cavg_housework_female_P*religionYN_P*genderE_A,
                    data = dat_dyad,
                    correlation = corCompSymm(form=~1|dyadID), 
                    weights = varIdent(form=~1|genderE_A), 
                    na.action = na.omit)

coef(summary(int_mod_religion))
```

## Exploratory Results














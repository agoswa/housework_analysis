---
title             : "Satisfying housework division? Gender role beliefs and religion as moderators of housework division and satisfaction"
shorttitle        : "gender roles, housework and satisfaction"

author: 
  - name          : "Carlotta Reinhardt"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding 
  - name          : "Margaret Bassney"
    affiliation   : "1"
  - name          : "Anushree Goswami"
    affiliation   : "1"
affiliation:
  - id            : "1"
    institution   : "Smith College"
   
# authornote: 

bibliography      : ["r-references.bib"]


floatsintext      : yes
figurelist        : yes
tablelist         : yes
footnotelist      : no
linenumbers       : yes
mask              : no
draft             : no

documentclass     : "apa6"
classoption       : "man"
output            : papaja::apa6_pdf
---

```{r analysis-preferences}
# Seed for random number generation
set.seed(42)
knitr::opts_chunk$set(cache.extra = knitr::rand_seed)
knitr::opts_chunk$set(include = FALSE)
```

```{r}
library(tidyverse)
library(nlme)
library(dplyr)
library(ggplot2)
library(rstatix)
```

```{r, include = FALSE}
dat_reverse <- read.csv("dat_reverse.csv")
dat_predyad <- read.csv("predyaddata.csv")
dat_dyad <- read.csv("dyadic.csv")
dat <- read.csv("TeleCom_Dyad_premeasures.csv")
```

## Analysis Strategy  

To test our hypotheses that gender role beliefs and religion moderate the relationship between housework distribution and satisfaction, we used multilevel modeling and the Actor-Partner Interdependence Model (APIM; Kenny, Kashy, & Cook, 2006). The APIM measures the effect of the explanatory variables for both members in a dyad at the same time. This way we get both the actor and partner effects. We will be able to see how one partner's housework distribution effects both their own satisfaction with the housework distribution and their partners satisfaction with the housework distribution. In terms of moderation, we will get an actor effect moderated by each members gender role beliefs and a partner effect moderated by each members gender role beliefs and religion. The APIM measures proportion of variance in satisfaction that occurs between dyads vs the total variation present. In other words, how much of the variation in satisfaction is caused by the dyad. This allows us to estimate satisfaction with the distribution of housework is a function of both housework distribution and the the random errors at both the individual and dyad level. This accounts for the nonindependent data. 

In order to calculate our APIM's we had to put our data into a paired data structure, where both the actor and the partner's data was contained all in one line. This way we could calculate the actor and partner effects for both the husbands and wives. 
(ref:my-figure-caption) Actor Partner Effects in the APIM

```{r my-figure, fig.cap = "(ref:my-figure-caption)", include=TRUE}
knitr::include_graphics("APIM_Housework_Distribution.pdf")
```
## Main Results

```{r}
## centering moderator and predictor
## calculate difference btw each individuals score and the grand mean of the entire sample
dat_dyad <- dat_dyad %>%
  mutate(
    Cavg_housework_female_A =  avg_housework_female_A- mean(avg_housework_female_A, na.rm = TRUE),
    Cavg_housework_female_P =  avg_housework_female_P- mean(avg_housework_female_P, na.rm = TRUE),
    Cavg_grbs_A =  avg_grbs_A- mean(avg_grbs_A, na.rm = TRUE),
    Cavg_grbs_P =  avg_grbs_P- mean(avg_grbs_P, na.rm = TRUE),
    religionYN_A = ifelse((religion_A == "Athiest"| religion_A =="Agnostic"),"N","Y"),
    religionYN_P = ifelse((religion_P == "Athiest"|religion_A == "Agnostic"), "N","Y"),
    grbs_hl_A = ifelse(avg_grbs_A > mean(avg_grbs_A, na.rm = TRUE),"High","Low"),
    grbs_hl_P = ifelse(avg_grbs_P > mean(avg_grbs_P, na.rm = TRUE),"High","Low"))
```


```{r}
## just the actor partner effects no moderation
basic_mod<- gls(housework_satisfied_A~as.factor(genderE_A)+
                    Cavg_housework_female_A:as.factor(genderE_A)+
                    Cavg_housework_female_P:as.factor(genderE_A),
                  data = dat_dyad,
                  correlation = corCompSymm(form=~1|dyadID), 
                  weights = varIdent(form=~1|as.factor(genderE_A)), 
                  na.action = na.omit)
summary(basic_mod)
```


Looking at the summary table above, the only relationship that is statistically significant is the one between the wife's satisfaction level and her average housework. We know this because the p-value for `as.factor(genderE_A)1:Cavg_housework_female_A` is 0.0041, which is less than 0.05. Since the value for this relationship is -0.029132, it signifies that as the wife's average housework increases, her satisfaction level decreases.


```{r}
## two intercept model gives us the two coefficients for men and women
## this model removes the grand mean so we are only left with actor/partner  
## effects using grbs and gender as a moderator
## we don't need every single combination as an interaction term, so we only 
## kept the ones that we are interested in and haven't already calculated. 
## by removing extra parameters we will get more accurate estimates.
two_int_mod<- gls(housework_satisfied_A~as.factor(genderE_A)+
                    Cavg_housework_female_A:as.factor(genderE_A)+
                    Cavg_housework_female_P:as.factor(genderE_A)+
                    Cavg_grbs_A:as.factor(genderE_A)+
                    Cavg_grbs_P:as.factor(genderE_A)+
                    Cavg_housework_female_A:Cavg_grbs_A:as.factor(genderE_A)+
                    Cavg_housework_female_P:Cavg_grbs_P:as.factor(genderE_A)+
                    Cavg_housework_female_A:Cavg_grbs_P:as.factor(genderE_A)+
                    Cavg_housework_female_P:Cavg_grbs_A:as.factor(genderE_A) -1,
                    data = dat_dyad,
                    correlation = corCompSymm(form=~1|dyadID), 
                    weights = varIdent(form=~1|as.factor(genderE_A) ), 
                    na.action = na.omit)

coef(summary(two_int_mod))
```


```{r}
hd_grbA_p_val<-p_format(coef(summary(two_int_mod))[12,4],accuracy = .05)

```


For women, her gender role beliefs significantly moderated the relationship between her own housework distribution and her satisfaction with the housework distribution. The moderation effect was `r coef(summary(two_int_mod))[12,1]` with a p value of `r hd_grbA_p_val` and a standard deviation of `r coef(summary(two_int_mod))[12,2]`. For every one unit increase in gender role beliefs, satisfaction increases by `r two_int_mod$coefficients[12]` while keeping housework distribution constant.Again for women, her partners gender role beliefs significantly moderated the relationship between her own housework distribution and her satisfaction with the housework distribution. The moderation effect was `r coef(summary(two_int_mod))[16,1]` with a p value of `r coef(summary(two_int_mod))[16,4]` and a standard deviation of `r coef(summary(two_int_mod))[16,2]`. For every one unit increase in her partners gender role beliefs, her own satisfaction increases by `r coef(summary(two_int_mod))[16,1]` while keeping housework distribution constant.


Looking at the summary table above, these are the relationships that are statistically significant: as.factor(genderE_A)1:Cavg_housework_female_A:Cavg_grbs_P, 8.742833e-03
as.factor(genderE_A)1:Cavg_housework_female_A:Cavg_grbs_A, 8.408625e-04
as.factor(genderE_A)0:Cavg_housework_female_A, 2.259373e-02

```{r}
#moderation approach
# moderation approach lets us know the difference between gender coefficients. are #the coefficients for men and women statistically different.
## check for gender interactions
mod<- gls(housework_satisfied_A ~ 
                Cavg_housework_female_A*Cavg_grbs_A*genderE_A +
                Cavg_housework_female_A*Cavg_grbs_P*genderE_A+
                Cavg_housework_female_P*Cavg_grbs_A*genderE_A +
                Cavg_housework_female_P*Cavg_grbs_P*genderE_A,
                    data = dat_dyad,
                    correlation = corCompSymm(form=~1|dyadID), 
                    weights = varIdent(form=~1|genderE_A), 
                    na.action = na.omit)

coef(summary(mod))
```


Only looking at the three way interactions with gender we found two significant gender differences in the moderation effects. The interaction between actors housework distribution and their own gender role beliefs was significantly different for husbands and wives with an estimate of `r coef(summary(mod))[15,1]` a p value of `r coef(summary(mod))[15,4]` and a standard deviation of `r coef(summary(mod))[15,2]`. The moderation effect of ones own gender role beliefs was `r coef(summary(mod))[15,1]` units higher for women than men meaning the moderation effect of gender role beliefs had a significantly larger positive effect on satisfaction for wives than for husbands. 
In addition the interaction between actors housework distribution and their partners gender role beliefs was significantly different for husbands and wives with an estimate of `r coef(summary(mod))[16,1]` a p value of `r coef(summary(mod))[16,4]` and a standard deviation of `r coef(summary(mod))[16,2]`.The moderation effect of ones partners gender role beliefs was `r coef(summary(mod))[16,1]` units lower for women than men meaning the moderation effect of her husbands gender role beliefs had a significantly larger negative effect on satisfaction compared to how her gender role beliefs effected the relationship between housework distribution and satisfaction for her husband. 


```{r}
wives <- dat_dyad %>%
  filter(genderE_A == 1)
```

```{r, include = TRUE}
wife_plot<- ggplot(wives,aes(
                x = Cavg_housework_female_A,
                y = housework_satisfied_A, color = grbs_hl_A)
                )+
  geom_point()+
  geom_smooth(method = "lm")+
  labs(x = "housework distribution", y = "Satisfaction", title = "Interaction of wives housework distribution and their gender role beleifs")
  
wife_plot
```
```{r, include = TRUE}
wife_plot2<- ggplot(wives,aes(
                x = Cavg_housework_female_A,
                y = housework_satisfied_A, color = grbs_hl_P)
                )+
  geom_point()+
  geom_smooth(method = "lm")+
  labs(x = "housework distribution", y = "Satisfaction", title = "Interaction of wives housework distribution and their husbands gender role beleifs")
  
wife_plot2
```

```{r}
## two intercept model
#this model removes the grand mean
## using religion and gender as  moderators
two_int_mod_religion<- gls(housework_satisfied_A~as.factor(genderE_A)+
                    Cavg_housework_female_A:as.factor(genderE_A)+
                    Cavg_housework_female_P:as.factor(genderE_A)+
                    religionYN_A:as.factor(genderE_A)+
                    #religionYN_P:as.factor(genderE_A)+
                    Cavg_housework_female_A:religionYN_A:as.factor(genderE_A)+
                    Cavg_housework_female_P:religionYN_P:as.factor(genderE_A)+
                    Cavg_housework_female_A:religionYN_P:as.factor(genderE_A)+
                    Cavg_housework_female_P:religionYN_A:as.factor(genderE_A) -1,
                    data = dat_dyad,
                    correlation = corCompSymm(form=~1|dyadID), 
                    weights = varIdent(form=~1|as.factor(genderE_A) ), 
                    na.action = na.omit)
coef(summary(two_int_mod_religion))
```
The two intercept model gives us the two coefficients for men and women

```{r}
#moderation approach
## check for gender interactions
 int_mod_religion<- gls(housework_satisfied_A ~
                       Cavg_housework_female_A*religionYN_A*genderE_A+
                       # Cavg_housework_female_A*religionYN_P*genderE_A+
                       Cavg_housework_female_P*religionYN_A*genderE_A,
                       # Cavg_housework_female_P*religionYN_P*genderE_A,
                    data = dat_dyad,
                    correlation = corCompSymm(form=~1|dyadID), 
                    weights = varIdent(form=~1|genderE_A), 
                    na.action = na.omit)

coef(summary(int_mod_religion))
```

## Exploratory Results













